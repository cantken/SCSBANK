<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>ç³»çµ±ä»£ç¢¼ç¶­è­·</title>
<link rel="stylesheet" type="text/css" href="/css/MappingCode.css">
<script>
	function handleButtonClick(action) {
		const addBtn = document.getElementById('addBtn');
		const queryBtn = document.getElementById('queryBtn');
		const queryDataBtn = document.getElementById('queryDataBtn');
		const saveDataBtn = document.getElementById('saveDataBtn');
		const addFormSection = document.getElementById('addFormSection');
		const updateDataBtn = document.getElementById('updateDataBtn');

		// æ¯æ¬¡é»æŒ‰éˆ•å‰å…ˆå…¨éƒ¨å•Ÿç”¨
		addBtn.disabled = false;
		queryBtn.disabled = false;
		queryDataBtn.disabled = false;
		saveDataBtn.disabled = false;

		if (action === 'add') {
			queryDataBtn.disabled = true;
			addFormSection.style.display = 'block';
		} else if (action === 'query') {
			saveDataBtn.disabled = true;
		}

		if (action === 'saveData') {
			const form = document.getElementById('addForm'); // ç²å–æ–°å¢è¡¨å–®
			if (form) { // ç¢ºä¿è¡¨å–®è¢«æ­£ç¢ºé¸å–
				form.submit(); // æäº¤è¡¨å–®
			} else {
				console.error('Form element not found!');
			}
		}
	}
</script>
</head>
<body>

	<div class="button-container">
		<button id="addBtn" type="button" onclick="handleButtonClick('add')">æ–°å¢</button>
		<button id="queryBtn" type="button"
			onclick="handleButtonClick('query')">æŸ¥è©¢</button>
		<button id="queryDataBtn" type="button"
			onclick="handleButtonClick('queryData')">æŸ¥è©¢è³‡æ–™</button>
		<button id="saveDataBtn" type="button"
			onclick="handleButtonClick('saveData')">å„²å­˜è³‡æ–™</button>
	</div>

	<hr>

	<!-- ğŸ”½ æ–°å¢è¼¸å…¥å€å¡Š -->
	<div id="addFormSection" style="display: none; margin-top: 20px;">
		<form id="addForm" action="/MappingCode/save" method="post">
			<!-- è¨­ç½®ç‚º POST è«‹æ±‚ -->
			<table>
				<tbody>
					<tr>
						<td><label for="codeType">ä»£ç¢¼é¡åˆ¥ï¼š</label></td>
						<td><select name="codeType" id="codeType" class="form-select">
								<option value="">-- ä»£ç¢¼é¡åˆ¥ --</option>
								<option th:each="code : ${dropList}" th:value="${code.codeNo}"
									th:text="${code.codeDesc}"></option>
						</select></td>
						<td><label for="codeNo">ä»£ç¢¼ï¼š</label></td>
						<td><input type="text" id="codeNo" name="codeNo"></td>
					</tr>
					<tr>
						<td><label for="codeDesc">ä»£ç¢¼èªªæ˜ï¼š</label></td>
						<td><input type="text" id="codeDesc" name="codeDesc"></td>
						<td><label for="codeFlag">æ˜¯å¦åœç”¨ï¼š</label></td>
						<td><select id="codeFlag" name="codeFlag">
								<option value="N">å¦</option>
								<option value="Y">æ˜¯</option>
						</select></td>
					</tr>
					<tr>
						<td><label for="codeTag">ä»£ç¢¼æ¨™ç±¤ï¼š</label></td>
						<td><input type="text" id="codeTag" name="codeTag"></td>
						<td><label for="codeSort">æ’åºï¼š</label></td>
						<td><input type="number" id="codeSort" name="codeSort"></td>
					</tr>
				</tbody>
			</table>
		</form>
	</div>
	<br>
	<br>

	<!-- âœ… æ•´åˆæŸ¥è©¢æ¢ä»¶èˆ‡è¡¨æ ¼çš„è¡¨å–® -->
	<form action="/MappingCode" method="get">
		<!-- æŸ¥è©¢æ¢ä»¶ -->
		<label for="sysType">ä»£ç¢¼é¡åˆ¥ï¼š</label> <select name="codeType"
			id="sysType" class="form-select">
			<option value="">-- ä»£ç¢¼é¡åˆ¥ --</option>
			<option th:each="code : ${dropList}" th:value="${code.codeNo}"
				th:text="${code.codeDesc}" th:selected="${code.codeNo == codeType}">
			</option>
		</select>
		<button type="submit">æŸ¥è©¢</button>

		<p th:if="${#lists.isEmpty(codeList)}">æŸ¥ç„¡è³‡æ–™</p>

		<hr>
		<br>

		<!-- æŸ¥è©¢çµæœ -->
		<table>
			<thead>
				<tr>
					<th></th>
					<th>ä»£ç¢¼é¡åˆ¥</th>
					<th>ä»£ç¢¼</th>
					<th>ä»£ç¢¼èªªæ˜</th>
					<th>æ’åº</th>
					<th>ä»£ç¢¼æ¨™ç±¤</th>
					<th>ä½¿ç”¨FLAG</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="code, iterStat : ${codeList}">
					<td>
						<button type="submit" name="editIndex"
							th:value="${iterStat.index}">ç·¨è¼¯</button>
					</td>
					<td th:text="${code.codeType}">ä»£ç¢¼é¡åˆ¥</td>
					<td th:text="${code.codeNo}">ä»£ç¢¼</td>
					<td th:text="${code.codeDesc}">ä»£ç¢¼èªªæ˜</td>
					<td th:text="${code.codeSort}">æ’åº</td>
					<td th:text="${code.codeTag}">ä»£ç¢¼æ¨™ç±¤</td>
					<td th:text="${code.codeFlag}">ä½¿ç”¨FLAG</td>
				</tr>
			</tbody>
		</table>
	</form>

</body>
</html>
